
---

# 外键约束开关
```mysql
SET FOREIGN_KEY_CHECKS=0; --- 关闭约束。
SET FOREIGN_KEY_CHECKS=1; --- 开启约束。
```

# 操作符
## 1. “.”点操作符


# MySQL多表记录数据查询 JOIN
## 连接查询 JOIN
使用场景：查询**多张表**中不同的实体数据。
前提条件： 被查询的表中必须存在**相同意义的字段**。
###  1. 内连接查询
使用比较运算符，对多个表间的某些列数据进行比较，并列出这些表中与连接条件相匹配的数据行，组合成新的记录。
关键字：INNER JOIN 
语法如下：
```mysql
	SELECT 列名1,列名2，... FROM 表1 INNER JOIN 表2 ON 连接条件;
```

举个例子：
```mysql
SELECT id, name, FROM watch1 INNER JOIN watch2 ON watch1.id=watch2.id;
```
两表都有 id 字段，可通过该字段建立两表的联系。

### 2. 自连接查询
指连接查询中涉及到的两张表在物理上是同一张表，但在逻辑上可以看出两张表。
关键字：INNER JOIN 
语法如下：
```mysql
	SELECT 列名1,列名2，... FROM 表1 AS 表1的别名1 INNER JOIN 表1 AS 表1的别名2 ON 连接条件;
```
这里用 AS 为表取两个别名，是为了防止产生二义性。

举个例子：
```mysql
	select s1.staff_id,s1.name,s2.money from
	staff as s1
	inner jostaff as s2
	on s1.staff_id = s2.staff_id
```

### 3. 外连接查询
以一张表为基表，根据连接条件，与另外一张表的每一行进行匹配，如果没有匹配上，则在相关联的结果行中，另一张表的所有选择列均返回空值。
关键字：OUTER JOIN、LEFT JOIN、RIGHT JOIN
注意：
- 对于先创建表关系，再插入数据的表，先要关闭**外键约束**，否则插入不成功。
- 完成数据插入后，再开启约束。
```mysql
SET FOREIGN_KEY_CHECKS=0; --- 关闭约束。
SET FOREIGN_KEY_CHECKS=1; --- 开启约束。
```

外连接查询分为3种：
1. 左连接查询
   语法格式如下：
	```mysql
	SELECT 字段名 FROM 表1 LEFT JOIN 表2 ON 连接条件;
	```

LETT JOIN 关键字之前的表为左表，以左表为基表，与另外一张表的每一行进行匹配，如果符合连接条件，则会返回两张表相对应的行，如果不符合，则只返回左表中的行，且其对应得行为null。

2. 右连接查询

   语法格式如下：
	```mysql
	SELECT 字段名 FROM 表1 RIGHT JOIN 表2 ON 连接条件;
	```

RIGHT JOIN 关键字之前的表为右表，以右表为基表，与另外一张表的每一行进行匹配，如果符合连接条件，则会返回两张表相对应的行，如果不符合，则只返回右表中的行，且其对应得行为null。

2. 全外连接查询（不支持）

   语法格式如下：
    ```mysql
	SELECT 字段名 FROM 表1 FULL OUTER JOIN 表2 ON 连接条件;
    ```

全外连接返回两个表中的所有记录，无论是否存在匹配项。对于没有匹配的记录，结果中另一表的字段将显示为 NULL。

### 3. 复合条件连接查询
在连接查询中添加过滤条件，以达到限制查询结果数量和筛选数据得目的。
语法格式如下：
```mysql
SELECT 字段名 FROM 表1 INNER JOIN 表2 ON 连接条件 WHERE 过滤条件;
```





## 2. 子查询
### 2.1 FROM 字句中的子查询


### 2.2 WHERE 字句中的子查询

|    关键字    | 说明  |     |
| :-------: | --- | --- |
|    IN     |     |     |
| ANY、SOME  |     |     |
|    ALL    |     |     |
|  EXISTS   |     |     |
| OPERATORS |     |     |




## 3. 合并查询结果


| 关键字       | 说明  |
| --------- | --- |
| UNION     |     |
| UNION ALL |     |




# 运算符
作用：用于执行数值运算。

## 1. 算数运算符

|  运算符   |                示例                 |             作用              |
| :----: | :-------------------------------: | :-------------------------: |
|   +    |             1+1（结果为2）             |           执行加法运算            |
|   -    |             2-1（结果为1）             |           执行减法运算            |
|   *    |            2\*5（结果为10）            |           执行乘法运算            |
| /（div） | 10\/2（结果为5.0000）<br>6/0 (结果为null) | 执行除法运算<br>若公式为非法运算，则结果为null |
| %（mod） |     4%3（结果为1）<br>9%0（结果为null）     |     执行求余运算<br>同样也会有非法运算     |

## 2. 比较运算符
作用：将表达式中的两个操作数进行比较，比较结果为真，则返回1，为假则返回0，结果不确定则返回null。
下面是MySQL中常用的比较运算符：

|     运算符     |          示例          |           作用           |
| :---------: | :------------------: | :--------------------: |
|   =（<=>）    |       0=1（返回0）       |         执行等于比较         |
|      <      |       2<1（返回0）       |         执行小于比较         |
|      >      |       2>1（返回1）       |         执行大于比较         |
|     <=      |      3<=3（返回1）       |        执行小于等于比较        |
|     >=      |      4>=3（返回1）       |        执行大于等于比较        |
|   <>（!=）    |      4!=4（返回0）       |        执行不等于比较         |
| BETWEEN AND | [[#3.1 BETWEEN AND]] |     判断一个值是否在两个值之间      |
|     IN      |     [[#3.2 IN]]      |     判断一个值是否在某个集合中      |
|   IS NULL   |   [[#3.3 IS NULL]]   |      判断一个值是否为null      |
|    LIKE     |    [[#3.4 LIKE]]     | 通配符匹配<br>判断一个值是否包含某个字符 |
|   REGEXP    |   [[#3.5 REGEXP]]    |        正则表达式匹配         |
|             |                      |                        |

**注意：**
1. 对于“=”：
	1. 可以进行null之间的比较。
	2. 如果两个操作数中有一个值或两个值为空，则结果为空。
	3. 如果两个操作数分别为字符串和数值，系统会先将字符串转换成数值，再进行比较。
2. 对于“!=”：
	1. 不能操作null。
3. 对于“<”，“>”，“<=”，“>=”：
	1. 不能操作null。
	2. 如果两操作符树都是字符串，系统会比较两个字符串的长度。
	3. 但两个操作数不能为一个数值，一个为字符串。


## 3. 特殊功能比较运算符
这里为 [[#2. 比较运算符]] 下半部分的运算符举了些例子。
### 3.1 BETWEEN AND
用于判断值是否在两个边界值之间（包含边界）。
```mysql
#示例：查询年龄在 18 到 30 岁之间的用户
SELECT * FROM 表名 WHERE 字段名 BETWEEN 18 AND 30;
```
### 3.2 IN
用于判断值是否在指定的集合中。
```mysql
#示例 1：查询性别为 “男” 或 “女” 的用户。
SELECT * FROM 表名 WHERE gender IN ('男', '女');
```
### 3.3 IS NULL
用于判断字段值是否为`NULL`（即未赋值）。
```mysql
#示例：查询未填写邮箱的用户。
SELECT * FROM 表名 WHERE email IS NULL;
```
### 3.4 LIKE
用于通配符匹配，常用通配符：`%`（匹配任意长度的字符）、`_`（匹配单个字符）。
```mysql
#示例 1：查询名字以 “张” 开头的用户。
SELECT * FROM 表名 WHERE name LIKE '张%';

#示例 2：查询名字第二个字是 “三” 的用户（如 “张三”“李三丰” 等。
SELECT * FROM 表名 WHERE name LIKE '_三%';
```
### 3.5 REGEXP
用于正则表达式匹配，可实现更灵活的字符模式匹配。
```mysql
#示例 1：查询名字中包含 “李” 的用户。
SELECT * FROM 表名 WHERE name REGEXP '李';
#示例 2：查询手机号为 11 位数字（符合国内手机号格式）的用户。
SELECT * FROM 表名 WHERE phone REGEXP '^1[0-9]{10}$';
```

## 4. 正则表达式运算符
REGEXP 运算符属于特殊功能运算符，但功能更强大，这里单独进行讲解。
REGEXP 需要搭配通配符使用：
R

|   通配符   |             作用             |                            示例                             |
| :-----: | :------------------------: | :-------------------------------------------------------: |
|    ^    |        匹配字符串的**开头**        |          `^Hello` 可匹配 “Hello World”（以 Hello 开头）           |
|    $    |        匹配字符串的**结尾**        |           World$` 可匹配 “Hello World”（以 World 结尾）           |
|    .    |     匹配除换行符外的**任意单个字符**     |                a.b 可匹配 “aab”，“acb”，“a1b” 等                |
|  [...]  |      匹配方括号中**任意一个字符**      |        `[abc]` 可匹配 “apple” 中的 `a`、“banana” 中的 `b`         |
| \[^...] |     匹配**不在**方括号中的任意字符      |    `[^abc]` 可匹配 “dog” 中的 `d`、`o`、`g`（若这些字符不在 a、b、c 中）     |
| p1\|p2  |          匹配p1或p2           | “k\|cat” 能匹配 ’k ‘或 “cat” 。“(k\|c)at” 可以匹配 “cat” 或 “cat” 。 |
|    *    |    匹配符号前面的字符**0 次或多次**     |            `a*` 可匹配 “”（空字符串）、“a”、“aa”、“aaa”……             |
|    +    |    匹配符号前面的字符**一次或多次。**     |                  “a0+” 能匹配 “ao” 及 “aoo”                   |
|   {n}   |    匹配符号前面的字符**恰好 n 次**     |                     `a{3}` 仅匹配 “aaa”                      |
|  {n,m}  | 匹配符号前面的字符**至少 n 次，最多 m 次** |               `a{2,4}` 可匹配 “aa”“aaa”“aaaa”                |

举个例子：
直接用 REGEXP 进行比较：
```mysql
SELECT 'abc' REGEXP '^a';
```
则返回布尔值 ’1‘，因为符合匹配。
如果是这样写：
```mysql
SELECT * FROM users WHERE name REGEXP '李';
```
那返回的是**符合匹配的数据表。**

## 5. 逻辑运算符
作用：又叫布尔运算符，用于确定表达式的真假。

| 运算符      | 示例                                                                         | 作用                                                |
| -------- | -------------------------------------------------------------------------- | ------------------------------------------------- |
| &&（and）  | 1 and 0（返回0）<br>1 and null（返回null）                                         | 逻辑与                                               |
| \|\|（or） | 1 or 0（返回1）<br>1 or null（返回1）<br>0 or null（返回null）<br>null or null（返回null） | 逻辑或                                               |
| !（not）   | !0（返回1）<br>not 1（规划0）<br>not null（返回null）                                  | 逻辑非                                               |
| xor      | 1 xor 1（返回0）<br>0 xor 0（返回0）<br>1 xor 0（返回1）<br>1 xor null（返回null）         | 逻辑异或<br>对于非 null 的操作数，如果两个操作数的逻辑值相异，则返回 1，否则返回 0。 |

## 6. 位运算符
位运算符是将给定的操作数转换位二进制数，然后对各个操作数的每一位进行指定的逻辑运算最后将二进制结构转换为十进制数。


| 运算符 |                   示例                    | 作用                                            |
| :-: | :-------------------------------------: | :-------------------------------------------- |
|  &  |                                         | 位于<br>只有当两个数都为1时，结果才为1，否则为0                   |
| \|  |                                         | 位或<br>两个数中，只要有一个为1，其结果就为1。<br>若两个数都为0，其结果才为0。 |
|  ^  |           1010^1111（返回 0101）            | 位异或<br>将两个数进行比较，若两者相同，则返回0。<br>若两者不相同，则返回1。   |
| <<  | 1<<2 同<br>0001 << 2<br>结果为0100（十进制数：4）  | 位左移<br>将二进制数全部向左移动n位，左边移出的位被舍弃，<br>右边空出的位补0。  |
| >>  | 2>>1 同<br>0010 >> 1<br>结果为0001（十进制数：10） | 位右移<br>将二进制数全部向右移动n位，右边移出的位被舍弃，<br>左边空出的位补0。  |
|  ~  |             ~0001（结果为1110）              | 位取反<br>将二进制数全部取反，1变0，0变1。                     |

## 7. 运算符优先级
略



---

# 存储过程和函数
首先更改SQL命令结束符，防止产生冲突。
```mysql
DELIMITER 新结束符号
 
 -- 如
 DELIMITER $$
```

存储过程和语法是两个东西，各有各的语法格式。

然后写过程，以下是过程的语法格式：
```mysql
-- 创建存储过程。
CREATE PROCEDURE 存储过程名(参数) 
	存储特性 
	BEGIN
		SQL语句集合;
	END$$
```
用 call 调用。

以下是函数语法格式：
```mysql
-- 创建函数。
CREATE FUNCTION f1()
RETURNS INT
READS SQL DATA
RETURN
(SELECT COUN(*) FROM b1)
$$
```
用 select 调用。




123456

---

# MySQL常用函数










---
# 待整理部分
## 字符匹配查询
```mysql
SELECT 字段名 FROM 表名 WHERE 字段名 LIKE valueb;
```
使用 % 匹配任意长度的字符。
使用 _ 匹配固定长度的字符。

## 数据表插入数据
```mysql
INSERT INTO 表名 (column1, column2, column3, ...)
VALUES (value1, value2, value3, ...);
```

## 数据表同时查询多个某字段的多个记录
```mysql
SELECT 字段名 FROM 表名 WHERE 字段名 IN (记录1, 记录2, ...);
```

## 升/降序排序（ASC）
```mysql
#升序排序
SELECT 字段名 FROM 表名 ORDER BY 字段名 ASC;
#降序排序
SELECT 字段名 FROM 表名 ORDER BY 字段名 DESC;
#同时为不同字段设置排序，用“，”隔开
SELECT 字段名 FROM 表名 ORDER BY 字段名1 ASC, 字段名2 DESC;
```

## 表范围查询
```mysql
SELECT 字段名 FROM 表名 WHERE 字段名 BETWEEN 开始范围 AND 结束范围;
```

## 表空值查询
```mysql
#使用
IS NULL
```









# mycli 遇到的问题
1.字符匹配查询下，某字段下的中文记录未显示
原因：
1. 分页导致的记录隐藏。
2. 列宽不足的内容截断。
3. 表头颜色与背景的冲突渲染。



| 配置模块             | 问题点                                                                   | 修改后的配置                                                                                                                                               | 修改效果                                                             |
| ---------------- | --------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------- |
| \[main]          | enable_pager = True<br>pager = 'less'<br>auto_vertical_output = False | enable_pager = False<br>pager = ''<br>auto_vertical_output = True                                                                                    | 1. 彻底禁用分页，避免结果集截断。<br>2. 宽记录自动垂直显示，适配长字段内容。                      |
| \[display]       | column_width = 30<br>charset = utf8mb4                                | column_width = 50<br>charset = utf8mb4                                                                                                               | 1. 扩大列宽至 50，适配中文长字段（如 “计算机技术与计算思维”）。<br>2. 强制 UTF-8 编码，解决中文显示异常。 |
| \[init-commands] | set_utf8mb4 = "SET character_set_results = utf8mb4"                   | set_utf8mb4 = "SET NAMES utf8mb4; SET character_set_client = utf8mb4; SET character_set_connection = utf8mb4; SET character_set_database = utf8mb4;" | 全链路同步字符集（客户端、连接、数据库、结果集），彻底避免编码断层。                               |
| \[colors]        | `output.header = "#00ff5f bold"`（与深色背景冲突，显示白块）                        | output.header = "#ffffff bold"                                                                                                                       | 表头（字段名）改为白色加粗，与深色终端背景形成高对比度，解决 “白方块” 渲染异常。                       |

mycli 的配置文件：![[myclirc.txt]]
mucli 的中文注释版配置文件：![[文件/mycli 配置文件（中文注释版）/myclirc.txt]]
记得将文件名改成：".myclirc"





